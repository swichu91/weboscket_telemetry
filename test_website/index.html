<!doctype html>
<html>
<head>
<title>WebSocket++ Telemetry Client</title>
</head>
<body>

<script src="socket.js" ></script>

    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <!-- jQuery and jQuery Mobile -->
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.1/jquery.mobile-1.3.1.min.css" />
    <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
	<script src="http://code.jquery.com/mobile/1.3.1/jquery.mobile-1.3.1.min.js"></script>

<script>

function OnCloseHandler(e) {
	document.getElementById("messages").innerHTML += "Client: The connection to "+socket.url()+" was closed. ["+e.code+(e.reason != "" ? ","+e.reason : "")+"]<br />";
	//cleanup_disconnect();
};

function OnErrorHandler(e) {
	document.getElementById("messages").innerHTML += "Client: An error occured, see console log for more details.<br />";
	console.log(e);
};

function OnOpenHandler(e) {
	document.getElementById("messages").innerHTML += "Client: A connection to "+socket.url()+" has been opened.<br />";
	
	document.getElementById("server_url").disabled = true;
	document.getElementById("toggle_connect").innerHTML = "Disconnect";
};

function OnMsgHandler(e) {
	//document.getElementById("output_view_id").value = e.data;
	document.getElementById("messages").innerHTML += e.data + "<br/>";
};


function toggle_connect() {
	if (document.getElementById("server_url").disabled === false) {
			
		socket.connect(document.getElementById("server_url").value);
		
		socket.registerOnClose(OnCloseHandler);
		socket.registerOnOpen(OnOpenHandler);
		socket.registerOnError(OnErrorHandler);
		socket.registerOnMsg(OnMsgHandler);
		document.getElementById("toggle_connect").name = "Disconnect";
		
	} else {
		socket.disconnect();
		document.getElementById("server_url").disabled = false;
		document.getElementById("toggle_connect").name = "Connect";
	}
}

function send_msg(){
	//document.getElementById("toggle_connect").innerHTML = socket.url();
	socket.emit("tempm",socketOpModSpecific,"555");
}


</script>

<style>
body,html {
	margin: 0px;
	padding: 0px;
	overflow:auto;
}
#controls {
	float:right;
	background-color: #999;
}

</style>



<div data-role="page" id="page1">

	<div id="controls" onload="myFunction()">
		<div id="server">
			<input type="text" name="server_url" id="server_url" value="ws://localhost:55555" /><br />
			<button id="toggle_connect" onclick="toggle_connect();">Connect</button><br />
			<input type="text" name="message_text" id="message_text_id" value="Test" /><br />
			<button id="send_msg" onclick="send_msg();">SendMsg</button>
		</div>
	</div>


    <div data-role="content">
        <div data-role="fieldcontain">
            <label for="slider1">
                Red LED
            </label>
            <input id="slider1" type="range" name="slider" value="0" min="0" max="100"
            data-highlight="false" data-theme="b" onChange="ledRed(value);">
        </div>
        <div data-role="fieldcontain">
            <label for="slider2">
                Yellow LED
            </label>
            <input id="slider2" type="range" name="slider" value="0" min="0" max="100"
            data-highlight="false" data-theme="b" onChange="ledYellow(value);">
        </div>
        <div data-role="fieldcontain">
            <label for="slider3">
                Green LED
            </label>
            <input id="slider3" type="range" name="slider" value="0" min="0" max="100"
            data-highlight="false" data-theme="b" onChange="ledGreen(value);">
        </div>
        <div data-role="fieldcontain">
            <label for="Demo">
                Demo Mode
            </label>
            <select name="toggleswitch1" id="Demo" data-theme="b" data-role="slider" onchange="demoSwitch(this);">
                <option value="off">Off</option>
                <option value="on">On</option>
            </select>
        </div>
        <div data-role="fieldcontain">
            <label for="Gyro">
                Gyroscope
            </label>
            <select name="toggleswitch2" id="Gyro" data-theme="b" data-role="slider" onchange="gyroSwitch(this);">
                <option value="off">Off</option>
                <option value="on">On</option>
            </select>
        </div>
    </div>
	
	<div id="outputview">
		<input type="text" name="output_view" id="output_view_id" value=""/><br />
	</div>
</div>

<div id="messages"></div>

</body>
</html>
